前面我们介绍了Excel中常用的查找和引用函数，在众多的查找和引用函数中，VLOOKUP函数是使用最频繁的，它是创建查询表的最好工具。如果你去面试的岗位要求中标明了熟练Excel的话，面试的时候基本都会问你使用过VLOOKUP吗？所以我们今天来通过一个实例来学习VLOOKUP。

lookup_value——需要在数据表第一列中进行查找的数值，可为数值、引用或字符串；

table_array——需要在其中查找数据的数据表，使用对区域或区域名称的引用；

col_index_num——table_array中将返回的匹配值的列号，col_index_num为1时，返回table_array第1列的值，col_index_num为2时，返回table_array第2列的值，以此类推；

range_lookup——为一逻辑值，指明查找时是精确匹配还是近似匹配。如果为FALSE或0，则进行精确匹配，如果找不到，则返回错误值“#N/A”；如果为TRUE或1，将查找近似匹配值，参数省略时默认为近似匹配。

一般企业都会有销售部门，管理部门的总经理会经常抽查销售部门的业绩情况，他担心部门经理在每季度汇报工作的时候虚报数据来人为拔高其部门的工作能力，因此年底时，总经理都会从基层的数据分析师处取得一张员工的销售记录表，用来了解实际情况。如下表所示的表格记录了销售部门20名应该在过去一年的销售业绩。

虽然只有二十条记录，但是有时候我们并不想全部看完，而只想随意抽查某些员工，来了解该部门的业绩分布。该表中列数太多，不便于横向查阅，因此我们可以为该表做一个简单的查询系统。

第2步：定义区域名称。在“原表”中，选取区域A1：M21，然后在“公式”下的“定义的名称”组中单击“定义名称”按钮，在弹出的“新建名称”对话框中的“名称”文本框输入“数据区域”，单击“确定”。如下图所示，此步骤是为了给所选定的区域命名，方便后面的操作中对该区域的引用。

第3步：添加下拉列表。切换至“查询表”中，选中B2单元格，然后在“数据”下单击“数据工具”组中的“数据验证”，在弹出的对话框中设置允许的验证条件为“序列”，然后在“来源”文本框引用“原表”中的A2：A21区域，即“员工编号”列，如下图上所示，此步骤是为了在B2中创建下拉列表，列表内容就是员工的编号，如下图下所示。

第4步：输入查询公式。在B3单元格输入公式“=VLOOKUP($B$2, 数据区域, 2)”，如下图所示，在该公式中，“$B$2”是需要查询的员工编号，“数据区域”是第2步中定义的区域名称，代表原表的A1：A21区域，以“员工编号”作为第一列，则“员工姓名”列为第2列，所以将第3个参数设置为“2”。

第5步：复制公式并修改参数。复制B3里的公式，粘贴到其他单元格，只需要修改第3个参数即可，如“年度总销售额”位于第11列，所以第3个参数为“11”，如下图所示。（由于还没有选择员工编号，所以所有的值都为“#N/A”）

第6步：查看结果。修改之后，我们直接在B2的下拉列表选择员工编号，如R1009，则会在其他单元格自动显示编号对应的其他信息。如下图所示。

VLOOKUP用于纵向查找，如果要横向查找，则需要用HLOOKUP函数，它的语法格式为HLOOKUP(lookup_value, table_array, row_index_num, range_lookup)，各参数的意义与VLOOKUP类似，但是注意，第三个参数是不同的，该参数返回的是在区域中的第几行。

建立查询表之后，如果想抽查员工在上一年的业绩情况，就很简单方便了，这不仅实现了对数据的随机查询，而且简化了原本复杂的查询工作。这样会对我们的工作效率很有帮助。

今天我们的主角就是VLOOKUPle ，希望通过上面的操作能帮助大家提高工作效率。如果你有什么好的意见，建议，或者有不同的看法，我都希望你留言和我们进行交流、讨论。